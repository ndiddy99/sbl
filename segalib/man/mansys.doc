*******************************************************************************
●readme.doc種別        ：各ライブラリ開発説明ファイル
●ファイル記号名称      ：mansys.doc
●対象ライブラリ記号名称：sys
●対象ライブラリ名称    ：システム プログラム
●バージョン　　        ：1.00
●作成者                ：T.S
●作成日                ：1994-08-31
●その他のメッセージ    ：なし
*******************************************************************************

＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊
    システム プログラム 関数仕様 について
    対象:  ＳＡＴＵＲＮ     Ｍｏｄｅｌ Ｓ
           ＢＯＯＴ ＲＯＭ  Ｖｅｒ．０.９２ 以降
＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

                         システムプログラム関数一覧
      ┌────────────────────┬────────────┐
      │           機             能            │      関   数   名      │
      ├────────────────────┴────────────┤
      │１．割り込み処理ルーチンの登録／参照                              │
      ├────────────────────┬────────────┤
      │割り込みベクタへ、処理ルーチンを登録する│ＳＹＳ＿ＳＥＴＳＩＮＴ  │
      │                                        │                        │
      │ＳＣＵ割り込みルーチンへ関数を登録する  │ＳＹＳ＿ＳＥＴＵＩＮＴ  │
      │                                        │                        │
      │割り込みベクタの登録内容を得る          │ＳＹＳ＿ＧＥＴＳＩＮＴ  │
      │                                        │                        │
      │ＳＣＵ割り込みルーチンの登録内容を得る  │ＳＹＳ＿ＧＥＴＵＩＮＴ  │
      ├────────────────────┴────────────┤
      │２．ＳＣＵ割り込みマスクのセット・参照・変更操作                  │
      ├────────────────────┬────────────┤
      │ＳＣＵ割リ込みマスクをセットする        │ＳＹＳ＿ＳＥＴＳＣＵＩＭ│
      │                                        │                        │
      │ＳＣＵ割り込みマスクを変更する          │ＳＹＳ＿ＣＨＧＳＣＵＩＭ│
      │                                        │                        │
      │ＳＣＵ割り込みマスクを参照する          │ＳＹＳ＿ＧＥＴＳＣＵＩＭ│
      ├────────────────────┴────────────┤
      │３．簡易セマフォ操作                                              │
      ├────────────────────┬────────────┤
      │セマフォを獲得する                      │ＳＹＳ＿ＴＡＳＳＥＭ    │
      │                                        │                        │
      │セマフォを解放する                      │ＳＹＳ＿ＣＬＲＳＥＭ    │
      ├────────────────────┴────────────┤
      │４．システムクロック切替え                                        │
      ├────────────────────┬────────────┤
      │システムクロックを切り替える            │ＳＹＳ＿ＣＨＧＳＹＳＣＫ│
      │                                        │                        │
      │システムクロック値を参照する            │ＳＹＳ＿ＧＥＴＳＹＳＣＫ│
      ├────────────────────┴────────────┤
      │５．ＳＣＵ割り込みルーチン優先度変更                              │
      ├────────────────────┬────────────┤
      │ＳＣＵ割り込みルーチン優先度を変更する  │ＳＹＳ＿ＣＨＧＵＩＰＲ  │
      ├────────────────────┴────────────┤
      │６．ＣＤマルチプレーヤ起動実行                                    │
      ├────────────────────┬────────────┤
      │ＣＤマルチプレーヤを起動実行する        │ＳＹＳ＿ＥＸＥＣＤＭＰ  │
      └────────────────────┴────────────┘


＊ 制限、変更および追加

(制限1)モデルＳ初期のもの（ＳＣＵバージョンが２.０以前のもの）では、
       ＳＣＵ割り込みルーチン登録／参照には ＳＹＳ＿ＳＥＴＵＩＮＴ、 および
       ＳＹＳ＿ＧＥＴＵＩＮＴ 使用が必須です。


       これらのＳＣＵの割り込みに対して、ＳＨは内部ベクタモードで応答します。
       したがって、ＳＣＵ割り込みベクタの範囲で ＳＹＳ＿ＳＥＴＳＩＮＴ、および
       ＳＹＳ＿ＧＥＴＳＩＮＴ 使用は禁止です。


       また、アプリで利用可能な、ＳＨ２のＳＲ割り込みマスク値に制限がつきます。

       ＜ＳＲ値の制限＞        割込み禁止の場合、１５    許可の場合、０
                               中間の １−１４ は使用禁止。

       ＜ＳＨ内臓モジュール    割込みの優先度設定は、０か １５のみ可。
          割り込みの制限＞


       なお、ＳＣＵ割込み処理ルーチンでは割り込みのレベルにかかわらず、ＳＲ値
       １５で実行します。


       該当ＢＯＯＴ ＲＯＭバージョン：
           Ｖ０.９２〜Ｖ０.９５２ （グラフィックボックス、ＣＤなし）
           Ｖ０.９６４            （プログラミングボックス、ＣＤあり）

       該当ＳＣＵバージョン：  ＳＣＵバージョンレジスタ値
                                （２５ＦＥ００Ｃ４Ｈ.Ｌ）
              １．５	              １
              ２．０                  ２


(制限2)モデルＳ（ＳＣＵバージョンが２.１以降のもの）では、
       ＳＹＳ＿ＳＥＴＳＩＮＴ、および ＳＹＳ＿ＧＥＴＳＩＮＴ 使用は制限ありま
       せん。ただし、ＳＣＵ割り込みに関して、割り込み処理ルーチン内で割り込み
       マスクを再設定する処理が必要になっています。
      （詳しくはＳＣＵ２．１以降に適用されるＳＣＵマニュアルを参照）


       ＳＣＵ割り込みルーチン登録／参照に ＳＹＳ＿ＳＥＴＵＩＮＴ、 および
       ＳＹＳ＿ＧＥＴＵＩＮＴ を使用する場合、前述のような処理は不要です。ただ
       し、以下の使用制限がつきます。


       ＜ＳＲ値の制限＞        割込み禁止の場合、１５    許可の場合、０
                               中間の １−１４ は使用禁止。

       ＜ＳＣＵ割り込み        割り込み処理ルーチン内での変更禁止。
          マスクの制限＞

       ＜ＳＨ内臓モジュール    割込みの優先度設定は、０か １５のみ可。
          割り込みの制限＞

       ＜補助サービス          ＳＣＵ割込み要因ごとに任意の優先度を設定する
         ルーチンの追加＞      ＳＹＳ＿ＣＨＧＵＩＰＲ の使用が可能


       該当ＢＯＯＴ ＲＯＭバージョン：
             ＳＣＵ２.１ 以降用のもの
                         ￣￣
       該当ＳＣＵバージョン：  ＳＣＵバージョンレジスタ値
                                （２５ＦＥ００Ｃ４Ｈ）
              ２．１                  ３
              ２．２                  ４


       なおモデルＳ(＋搭載のＳＣＵ)と、動作可能なＢＯＯＴＲＯＭバージョンは
       下表のとおり。
      ┌──────────┬─────────┬──────────┐
      │モデルＳタイプ      │ＳＣＵ１.５〜２.０│ＳＣＵ ２.１〜      │
      ├──────────┼─────────┼──────────┤
      │グラフィックＢＯＸ  │ Ｖ０.９５２以前  │  Ｖ０.９５３       │
      ├──────────┼─────────┼──────────┤
      │プログラミングＢＯＸ│ Ｖ０.９６４      │  Ｖ０.９７４       │
      └──────────┴─────────┴──────────┘


(制限3)ＳＣＵ割り込み関係操作、およびクロック切替え操作を使用する場合、制御を
       行なうのはマスタＳＨに限定してください。


(変更1)割込みベクタ登録／参照で、マスタＳＨから ＳＹＳ＿ＳＥＴＳＩＮＴ または
       ＳＹＳ＿ＧＥＴＳＩＮＴ で、以下のベクタ番号の値を使用可能とします。
       ただし、スレーブＳＨが起動後は、マスタ−スレーブ間で不都合が生じない
       ようにしてください。（キャッシュパージしないため）

         ９４Ｈ      ＳＭＰＣコマンドによるスレーブＳＨ起動後に、
                     スレーブＳＨが最初に実行するアプリケーションを登録／参照
                     できます。
                     なお、デフォルトでは、割込み待ちの無限ループに入ります。

       １００Ｈ      スレーブＳＨの ０Ｈ〜７ＦＨ に相当する、スレーブＳＨ割込み
        〜１７ＦＨ   割込みベクタ登録／参照できます。

                     ただし、これらの番号はマスタＳＨのみから使用可能です。


(追加1)プログラム開発用に、リセット時のロゴデモや、ＣＤマルチプレーヤなどを
       中断し、システムを再初期化するエントリーが付きました。
       
       Ｅ７０００エミュレータでは、以下のように使用可能です。
                         （何らかのプログラム実行中...）
                          <ctrl-Ｃ>                 （ＢＲＥＡＫ）
                          Ｇ  ４００<Enter>
                          <ctrl-Ｃ>                 （ＢＲＥＡＫ）

       Ｇ ４００以降、初期化は１秒以内で終了します。初期化完了後は、画面は黒く
       消えたまま、プログラムは無限ループに入ります。

       その後ＢＲＥＡＫした時点で、ＰＣ＝６０００ｘｘｘＨ であれば完了です。
       以後、アプリケーションのロード、実行は普通に行なえます。


       該当ＢＯＯＴ ＲＯＭバージョン：
           Ｖ０.９２〜Ｖ０.９５２
           Ｖ０.９５３以降

       なお、Ｖ０.９２〜Ｖ０.９５２ では、この際にＤＲＡＭ、ＳＤＲＡＭ はクリア
       されます。

       Ｖ０.９５３以降では、ＳＤＲＡＭ はその前の状態を保持します。
      （ベクタテーブルを除く、ベクタテーブルは再初期化）


(追加2)モデルＳでは、システムクロック切替えが可能です。この機能は、

              ＣＰＵクロック    ２６ＭＨｚ     ←→    ２８ＭＨｚ
              水平解像度      ３２０／６４０   ←→  ３５２／７０４

       システムクロック切替えは、ＳＭＰＣへの単独コマンド発行ではできません。
       本システムプログラムを使用してください。


(追加3)スレーブＳＨへ割り込み信号が追加されました。スレーブには、マスタにある
       ようなＳＲマスクの制限はありません。逆に、割り込みを禁止するには、ＳＲ
       マスクを使用しなければなりません。

       スレーブＳＨへの割り込み信号：
             ＨブランクＩｎ  ･･･  ＩＲＬ２割り込み（ベクタ４１Ｈ）
             ＶブランクＩｎ  ･･･  ＩＲＬ６割り込み（ベクタ４３Ｈ）

       また、この割り込みはレベル信号入力で、例えば、ＶブランクＩｎ 割り込み
       処理が開始され、完了しても、なおＶブランク期間中であれば、再び割り込み
       処理が開始されることになります（Ｈブランクも同様）。

       割り込み受け付けを単一にするしくみは、アプリケーションが請け負わなけれ
       ばなりません。


(追加4)アプリケーションからＣＤマルチプレイヤーを起動実行できます。
       呼び出しは通常のＲＯＭコールと同様ですが、呼び出し元には戻りません。

       プログラミングＢＯＸ（ＣＤ付き）で使用可能です。
      （バージョン Ｖ０.９６４、 Ｖ０.９７４）

       注意   グラフィックＢＯＸ、およびグラフィックＢＯＸ用ＢＯＯＴ ＲＯＭでは
              使用できません。コールしてはいけません。


＊バグ情報 ･･･

    (1)該当ＢＯＯＴＲＯＭバージョン：
           Ｖ０.９２〜Ｖ０.９５

       ＳＨのＦＲＴインプットキャプチャ割り込みの設定に関して

            ・起動時、ＦＲＴのＴＩＥＲにインプットキャプチャ割り込みを許可を
              セットしていません。（マスタ、スレーブ共）
            （ＴＩＥＲに設定されている値   ０１Ｈ）
         
            ・クロック切替え後、またはホットリセット後、ＦＲＴのＴＩＥＲにイン
              プットキャプチャ割り込みを許可をセットしています。（マスタ）
            （ＴＩＥＲに設定されている値   ８１Ｈ）

       いずれの時点でもＴＩＥＲに本来設定されるはずの値 は    ８１Ｈ です。

            ・起動時、インプットキャプチャ割込み優先度 (ＳＨ割込みのＩＰＲＢ)を
              １に設定しています。この値は、マスタではＳＣＵ割り込み使用制限に
              入ります。(ＳＲ中間値の禁止に対し、割り込み時ＳＲが１になるため)

       マスタ、スレーブともＩＰＲＢに本来設定されるはずの値は ０ＦＨ です。


       (対策) スレーブへはＴＩＥＲを、マスタへはＴＩＥＲ、ＩＰＲＢのセットを
              行なうようにしてください。

              インプットキャプチャを割り込み制御で行なう場合は
                          ＴＩＥＲ   ８１Ｈ        ＩＰＲＢ   ０ＦＨ

              ポーリングで行なう場合は
                          ＴＩＥＲ   ０１Ｈ


    (2)該当ＢＯＯＴＲＯＭバージョン：
           Ｖ０.９２〜Ｖ０.９５１

       ＩＰＬからのアプリケーション起動に関して

            ・ライセンスロゴが表示されません。約２秒間ＴＶ ＯＦＦのまま（ただし
              長い１ｓｔリードファイルがあれば、延長します）で、それからアプリ
              ケーションに実行が移ります。
         
            ・ＶＤＰ２のレジスタイニシャライズが不定になっています。なお、アプ
              リケーションでＶＤＰ２全レジスタの再イニシャライズが行われれば、
              アプリケーション実行に悪影響はありません。


＊追加仕様詳細

４． システムクロック切替え

概要   システムクロック切替えでは、一部ハードウェアへのリセットを伴うため、単に
       ＳＭＰＣの該当コマンドを発行するだけでなく、その前後処理を行なってます。

       システムクロック切替え後のハードウェア状態について：

       リセットされるデバイス   ＯＦＦまたは無保証デバイス   影響のないデバイス
       ￣￣￣￣￣￣￣￣￣￣￣   ￣￣￣￣￣￣￣￣￣￣￣￣￣   ￣￣￣￣￣￣￣￣￣
       ＳＣＵ                   スレーブＳＨ（ＯＦＦ）       マスタＳＨ ＊注
       ＶＤＰ１                 ＤＲＡＭ（以前の内容破壊）   ＳＤＲＡＭ
       ＶＤＰ２                 ＳＣＳＰ（ＯＦＦ）           ＣＤ
       ＳＣＳＩ／ＳＣＣ                                      ＳＩＭＭ

                              ＊注 ･･･ マスタＳＨは、クロック切替え中に
                                       スタンバイ・モードになるため、ＳＨ内臓
                                       モジュールのうちＦＲＴ、およびＳＣＩは
                                       再設定が必要になります。なお、ＷＤＴは
                                       この処理の中で使用されています。

                                       また、処理後、ＮＭＩがあった状態になり、
                                       例えばＤＭＡＣのコントロールはＮＭＩに
                                       よる中断状態になっています。ＳＨマニュ
                                       アルを参照し、必要ならば処理再開のため
                                       の処理を行なってください。


       リセット後再初期化処理について：

       ＳＣＵ ･･･  バス、割込みマスクなど再初期化。ただし、割込みマスク値には
                   ＳＹＳ＿ＧＥＴＳＣＵＩＭの値を使用。

       ＳＣＳＩ･･･ 再初期化（リセット時ホストと伝送中でなかった場合、継続使用
        ／ＳＣＣ   可能な状態に復元）


       アプリケーションで必要となる後処理について：

       ＶＤＰ２･･･ ＴＶモードを比較的早く設定する必要があります。デバイス自体は
                   リセット後３２０／６４０モードとなるため、特に、システム
                   クロックを３５２／７０４モードに変更した場合、ＴＶに対して、
                   同期信号がずれており、画面が乱れるものがあります。

       ＶＤＰ１、２、ＳＣＳＰ･･･ 以前の設定はすべて無効です。再設定が必要です。


       クロックチェンジの処理時間は、約１３０ｍｓ （〜Ｖ０.９６ｘ）です。
       これは、デバイスのリセット時間を含むためです。


       Ｃ言語でこれらの関数を使用するには、下記を記述してください。
       ＃ｉｎｃｌｕｄｅ  "ｓｅｇａ＿ｓｙｓ.ｈ"

       なお、ｓｅｇａ＿ｓｙｓ.ｈ中に、簡単な使用例のコメントがあります。

-------------------------------------------------------------------------------
システムクロックを切り替える                           ＳＹＳ＿ＣＨＧＳＹＳＣＫ
-------------------------------------------------------------------------------

（Ｃインターフェース）
書式   ｖｏｉｄ  ＳＹＳ＿ＣＨＧＳＹＳＣＫ（Ｕｉｎｔ３２  ＣｋＭｏｄｅ）；
入力   ＣｋＭｏｄｅ：  ０：ＣＰＵ ２６ＭＨｚ、３２０／６４０モード
                       １：ＣＰＵ ２８ＭＨｚ、３５２／７０４モード
出力   なし
関数値 なし

（アセンブラインターフェース）
書式   アドレスＨ'６０００３２０．Ｌの内容のアドレスにサブルーチンコールする
入力   Ｒ４：  ０：ＣＰＵ ２６ＭＨｚ、３２０／６４０モード
               １：ＣＰＵ ２８ＭＨｚ、３５２／７０４モード
出力   なし
破壊   Ｒ０−Ｒ７

機能   ＣｋＭｏｄｅ／Ｒ４で指定された値にシステムクロックを切り替えます。

備考   リセットされるデバイスや処理時間に関して、概要やＳＭＰＣマニュアルを参照
       してください。

-------------------------------------------------------------------------------
システムクロック値を参照する                           ＳＹＳ＿ＧＥＴＳＹＳＣＫ
-------------------------------------------------------------------------------

（Ｃインターフェース）
書式   Ｕｉｎｔ３２  ＳＹＳ＿ＧＥＴＳＹＳＣＫ；
入力   なし
出力   なし
関数値 ０または１： 最後のＳＹＳ＿ＣＨＧＳＹＳＣＫ（ ）のパラメータ値

（アセンブラ インターフェース）
書式   アドレスＨ’６０００３２４．Ｌのアドレスの内容を読み出す。
入力   なし
出力   なし
破壊   なし

機能   システムクロック値を読みだします。最後にＳＹＳ＿ＣＨＧＳＹＳＣＫ（ ）が
       呼ばれた時のパラメータ値です。


５． ＳＣＵ割り込み優先度変更

概要   ＳＣＵ２.１以降用のＢＯＯＴ ＲＯＭでは、ＳＣＵ割り込み処理サービス用の、
       割り込み優先度管理テーブルを持っており、また、その書き換えを可能にして
       います。

       注意  これは危険なサービスであり、テーブル内容に優先度関係の矛盾があれば
             システムがハングアップする可能性があります！！！


       これにより、割り込み処理(ＳＹＳ＿ＳＥＴＵＩＮＴ利用のもの)をアプリケー
       ションに最適化できます。

       そのためには、アプリケーションはそのテーブルと同一構造のデータを用意し、
       ＳＹＳ＿ＣＨＧＵＩＰＲ をコールしてください。

       テーブルは３２ロングワードで、１ロングワードは以下の内容を持ちます。

        ┌─────────────┬─────────────────┐
        │ ＳＨ２ ＳＲ下位ワード値  │ ＳＣＵ割り込みマスク下位ワード値 │
        └─────────────┴─────────────────┘
         割り込み処理開始時、ＳＲに   割り込み処理開始時、ＳＣＵ割り込み
         設定される値                 マスクレジスタに、現在のマスク設定値と
                                      論理和（ＯＲ）されて書き込まれる値


       テーブル中のこのロングワードの位置は、ＳＣＵの３０のベクタに対応します。
       （Ｖ−Ｂｌａｎｋ Ｉｎ が先頭、Ｖ−Ｂｌａｎｋ Ｏｕｔ が第２、．．．）

       実際には、最大限の注意を払って、ＳＲ、ＳＣＵ割り込みマスクと、割り込み
       要因とが矛盾が無いようテーブルを作成しなければなりません。


       例えば ＢＯＯＴ ＲＯＭは、次のようなテーブルを初期設定値としています。

       Uint32 PRITab[３２]＝{
           ０ｘ００Ｆ０ＦＦＦＦ,  /* ＶＢＩ  ＳＲ＝１５ 全禁止（最高優先）   */
           ０ｘ００Ｅ０ＦＦＦＥ,  /* ＶＢＯ  ＳＲ＝１４ ＶＢＩのみ許可       */
           ０ｘ００Ｄ０ＦＦＦＣ,  /* ＨＢＩ  ＳＲ＝１３ ＶＢＩ、ＶＢＯを許可 */
                                       ・
                                       ・
           ０ｘ００７０ＦＥ００   /* 外部１５  ＳＲ＝７ ＳＣＵ割り込みの固有
                                                  優先度で７以下すべてマスク */
                                  /* Ａバス割り込み固有優先度は要因別に ７,４,
                                     １だが、共用で１bitマスクのため ７とする*/
       }；

       作成例として、ＳＲ値を常に０にし、ＳＣＵマスク値のみで優先度(優先関係)を
       記述する例を示します。この場合、ＳＨは常に割り込み受け付け可能であり、
       ＳＣＵマスクのみが許可、禁止を制御することになります。

       Uint32 PRITab[３２]＝{
           ０ｘ００００ＦＦＦ９,  /* ＶＢＩ処理中、ＨＢＩ、ＶＢＯ許可        */
           ０ｘ００００ＦＦＦＢ,  /* ＶＢＯ処理中、ＨＢＩのみ許可            */
           ０ｘ００００ＦＦＦＦ,  /* ＨＢＩ処理中、すべて禁止（最高優先）    */
                                       ・
                                       ・
           ０ｘ００００００００   /* 外部１５処理中、すべて許可（最低優先）  */
       }；

       上記例と逆に、ＳＣＵマスク値を変更せず、ＳＲ値レベルで割り込みをマスク
       するのは禁止！！！（０または１５のみ可能）

       上記例では、ＳＨ内臓モジュールの割り込み許可、禁止についても、その内臓
       モジュールごとの割り込み許可、禁止レジスタを操作しなければなりません。

       注意  ＳＣＵのある要因の割り込みが許可になっていて、その割り込みが発生し
             たとき、その割り込みの固有のレベル（ＳＣＵハードで決まっている値）
             よりも、ＳＨのＳＲマスクが高く、ＳＨで割り込みが拒絶されてしまう
             状態が決して起こり得ないならば、ＯＫです。
            （ただし、例外的に、ＳＲマスク１５の全禁止は可能）


       Ｃ言語でこの関数を使用するには、下記を記述してください。
       ＃ｉｎｃｌｕｄｅ  "ｓｅｇａ＿ｓｙｓ.ｈ"

       なお、ｓｅｇａ＿ｓｙｓ.ｈ中に、簡単な使用例のコメントがあります。

-------------------------------------------------------------------------------
ＳＣＵ割り込みルーチン優先度を変更する                 ＳＹＳ＿ＣＨＧＵＩＰＲ
-------------------------------------------------------------------------------

（Ｃインターフェース）
書式   ｖｏｉｄ  ＳＹＳ＿ＣＨＧＵＩＰＲ（Ｕｉｎｔ３２  ＊ＩｐｒＴａｂ）；
入力   ＩＰＲＴａｂ：  ３２ロングワードのデータ配列
出力   なし
関数値 なし

（アセンブラインターフェース）
書式   アドレスＨ'６０００２８０．Ｌの内容のアドレスにサブルーチンコールする
入力   Ｒ４：  ３２ロングワードのデータ先頭アドレス
出力   なし
破壊   Ｒ０−Ｒ４

機能   ＢＯＯＴ ＲＯＭ が持つＳＣＵ割り込みルーチン用の優先度テーブルを、
       ＩＰＲＴａｂ／Ｒ４に指定されたテーブルの値で書き換えます。

       一度書き換えを行なうと、ＳＣＵ割り込みルーチンによる割り込み処理は、
       要因ごとに、該当するそのテーブル値の優先度で実行されるようになります。

       注意！！！ テーブル内容をチェックしていません。テーブル内容に優先度関係
       の矛盾があれば、システムがハングアップする可能性があります！！！


備考   次に書き換えるまで、テーブルの設定は有効です。その間、パラメータに指定
       したテーブルをアプリケーションで保持する必要はありません。
       なお、リセット時には ＢＯＯＴ ＲＯＭの初期設定値に戻ります。


６． ＣＤマルチプレーヤ起動実行

概要   アプリケーション終了時などに、ＣＤマルチプレーヤを起動し実行するサービス
       です。

       本サービスを呼び出すと、呼び出した状態にかかわらず、パワーオンシーケンス
       からの起動と全く同じに、ＣＤマルチプレーヤを実行している状態になり、呼び
       出し側には戻りません。


       Ｃ言語でこの関数を使用するには、下記を記述してください。
       ＃ｉｎｃｌｕｄｅ  "ｓｅｇａ＿ｓｙｓ.ｈ"

       なお、ｓｅｇａ＿ｓｙｓ.ｈ中に、簡単な使用例のコメントがあります。

-------------------------------------------------------------------------------
ＣＤマルチプレーヤを起動実行する                       ＳＹＳ＿ＥＸＥＣＤＭＰ
-------------------------------------------------------------------------------

（Ｃインターフェース）
書式   ｖｏｉｄ  ＳＹＳ＿ＥＸＥＣＤＭＰ（ｖｏｉｄ）；
入力   なし
出力   呼び出し元に戻りません
関数値 

（アセンブラインターフェース）
書式   アドレスＨ'６０００２６Ｃ．Ｌの内容のアドレスにサブルーチンコールする
入力   なし
出力   呼び出し元に戻りません
破壊   

機能   ＣＤマルチプレーヤを起動実行します。

注意   グラフィックボックス、およびグラフィックボックス用ＢＯＯＴ ＲＯＭでは
       使用できません。コールしてはいけません。


＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊
    ＢＯＯＴ ＲＯＭ  ＩＰ 仕様について
    対象:  ＳＡＴＵＲＮ     Ｍｏｄｅｌ Ｓ
           ＢＯＯＴ ＲＯＭ  Ｖｅｒ．０.９２以降
＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

(1) ブートコード（sys_id.src ＋ sys_sec.obj）への
    エリアコード（sys_arej.obj, sys_aret.obj, sys_areu.obj, sys_areb.obj,
                  sys_arek.obj, sys_area.obj, sys_aree.obj, sys_arel.obj)
    の追加について

    システムＩＤ内、対応エリアに記した文字 "ＪＴＵＢＫＡＥＬ"に従い、
    必要なエリアコードを選択し、連結してください。（エリアコードファイル名
    ８番目の文字がそれぞれに対応します。）

              ┌─┌─────────┐ - - - - -    ─┐
              │  │システム ＩＤ     │ １００Ｈ       │ブートコード
              │  ├─────────┤ - - - - -      │
              │  │セキュリティコード│ Ｄ００Ｈ       │
             ＩＰ ├─────────┤ - - - - -      │
              │  │エリアコード      │ ２０〜１００Ｈ │
              │  ├─────────┤ - - - - -    ─┘
              │  │アプリケーション  │ １００Ｈ〜
              │  │初期化プログラム  │   ７１Ｅ０Ｈ
              └─└─────────┘

    また、システムＩＤ sys_id.src およびセキュリティコード sys_sec.obj が変更に
    なっています。以前のバージョン（Ｖ０.９１以前）と互換性がありません。

    なお、モデルＳ（ＣＤ付きプログラミングボックス、Ｖ０.９６）以降、マシンの
    ディップＳＷで設定されるエリアコード設定値が、ブートコード内の対応エリア
    およびエリアコードに合致しない場合、アプリケーションは起動できません。


(2) アプリケーション初期化サンプル smpsys.src について

    サンプルは、システムＩＤの１ｓｔリード項目指定により、既に、１ｓｔリード
    アドレスにロード済みのアプリケーションへ、分岐するものです。
    これは単純にＨ'６０１００００への分岐命令のみの内容になっています。
    サイズは１００Ｈで、ＩＰサイズはこれを含んで１０００Ｈになります。

                          （セクション名）
          ┌─  - - - - - ┌─────────┐ - - - - -  ─┐
      ＩＰ│              │ＳＹＳＩＤ        │  Ｆ００Ｈ    │ブートコード
          │  １０００Ｈ  ├─────────┤ - - - - -  ─┘
          │              │Ｐ  (smpsys.obj)  │  １００Ｈ    
          └─  - - - - - └─────────┘

(3) 先読み可能なエリアについて

    サンプルで先読み開始エリア(start 1st-read）は、６０１００００Ｈです(これは
    下限ではありません)。 アドレス指定は、ＳＤＲＡＭ上では先頭アドレスの下限は
    ６００２０００Ｈ＋ＩＰサイズ（この場合、ＩＰの実際の使用サイズ）です。

   （参考） H'6000000┌───────────┐  （Ｖ０.９２以降）
                     │ システムワーク領域   │
            H'6002000├───────────┤
                     │ＩＰロードエリア      │
                     │ＩＰ処理後は解放      │
            H'6002000├ ─ ─ ─ ─ ─ ─ ─ ┤
           + IPサイズ│                      │
                     〜                      〜

(4) システムワーク領域について

    ＳＤＲＡＭ上では先頭アドレス指定が ６００２０００Ｈ より下は、システム領域
    です。しかし、ＩＰ処理が完了して、アプリケーションが起動している状態では、
    マスタ、スレーブＳＨ それぞれのスタックを他に用意すれば、６００１０００Ｈ、
    ６０００Ｅ００Ｈ まで自由使用可能です。


   （参考） H'6000000┌───────────┐  （Ｖ０.９２以降）
                     │ ベクタ、常駐ルーチン │
            H'6000E00├───────────┤
                     │スレーブＳＨスタック  │
            H'6001000├───────────┤
                     │マスタＳＨスタック    │
            H'6002000├───────────┤
                     │                      │
                     〜                      〜

(5)  サンプル  ＩＰ.ＢＩＮ の実機上へのダウンロード、実行について

     ＝＝＝ ＳＩＭＭ を カートリッジ代わりとする方法 ＝＝＝

     本体ディップＳＷの「ＳＩＭＭ ＣＡＲＴ」をＯＮにし、一度再起動を行なえば、
     ＳＩＭＭはカートリッジエリアと同一の Ｈ'２００００００ から割り当てられま
     す(注)。ここで、
           
           Ｌ ２００００００ ；Ｍ：ＩＰ．ＢＩＮ
           Ｌ ２００１０００ ；Ｍ：ＡＰＰ．ＢＩＮ

           ＲＳ
           Ｇ

     で再起動すると、起動画面表示の後、アプリケーションが実行されます。
     これ以後、本体リセットボタンで毎回起動するようになります。

    （注） ＳＣＳＩによるＣＤファイル     H'4000000┌───────────┐
           エミュレーションは使用でき              │ＳＣＳＩ 常駐ルーチン │
           なくなります。                 H'4020000├───────────┤
                                                   │ＳＩＭＭ  ＣＤファイル│
           ＳＣＳＩを使用する場合には、            │エミュレーション      │
           本体ディップ「ＳＣＳＩＯＮ」            ├ ─ ─ ─ ─ ─ ─ ─ ┤
           がＯＮで、「ＳＩＭＭＣＡＲＴ」          │                      │
           はＯＦＦでなければなりません。          〜                      〜
           なお、次に説明するＳＩＭＭを
           ＣＤファイルシステムとして用いる場合、ＳＣＳＩは併用できます。


     ＝＝＝ ＳＩＭＭ を ＣＤファイルシステム代わりとする方法 ＝＝＝

     まず、ＤＯＳ上でＭＦＣＡＴを用いて

        ＭＦＣＡＴ  −ｏＡＰＰ.ＬＯＤ  ＩＰ.ＢＩＮ  ＩＰ.ＢＩＮ  ＡＰＰ.ＢＩＮ

     とし、（これは、３ファイルからなるファイルシステムを意味します。また、
             １番目は、常にＩＰ.ＢＩＮである必要があり、２番目はダミーであり、
             ３番目はファイル名によらず １ｓｔ−ｒｅａｄ ファイルになります）

     ＡＰＰ.ＬＯＤ を作成しておき、

 
     本体ディップＳＷの「ＳＩＭＭ ＣＡＲＴ」をＯＦＦし、一度再起動を行なえば、
     ＳＩＭＭは Ｈ'４００００００ から割り当てられます。ここで、


     続いて、ロード系コマンド＋オフセット値を使用し ip.mot と app.mot を
     ダウンロードしてください（注１０）。
           
           Ｌ ４０２００００ ；Ｍ：ＡＰＰ.ＬＯＤ

           ＲＳ
           Ｇ

     で再起動すると、起動画面表示の後、アプリケーションが実行されます。
     これ以後、本体リセットボタンで毎回起動するようになります。

                                                                     以   上
＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊
